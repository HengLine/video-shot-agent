version: "2.0"

video_splitter:
  name: "智能视频分割器 - 保持连贯性"
  description: "将长镜头智能分割为适合AI视频生成的片段，保持视觉和叙事的连贯性"
  template: |
    # 视频镜头智能分割任务
    
    ## 当前镜头信息
    - 镜头ID: {shot_id}
    - 描述: {description}
    - 时长: {duration}秒
    - 镜头类型: {shot_type}
    - 主要角色: {main_character}
    
    ## 上下文信息
    {scene_info}
    {prev_context}
    {next_context}
    
    ## 连续性要求
    {continuity_notes}
    
    ## 分割参数
    - 分割阈值: 超过{split_threshold}秒的镜头考虑分割
    - 单片段最小时长: {min_segment}秒
    - 单片段最大时长: {max_segment}秒
    
    ## 分割原则
    1. 动作连贯性: 动作序列应该保持完整，分割点在动作自然停顿处
    2. 对话完整性: 对话应该以完整的句子为单位分割
    3. 场景一致性: 确保同一场景内的片段保持相同的视觉风格
    4. 角色连续性: 保持主要角色在分割片段中的一致性
    5. 视觉元素连贯性: 确保分割片段之间的视觉元素（如背景、道具）保持一致
    6. 情感连贯性: 保持情感氛围的一致性，避免在分割点出现突变
    7. 转场合理性: 分割点应考虑转场效果，避免突兀的切换
    8. 叙事连贯性: 确保分割后的片段在叙事上保持连贯，避免信息丢失或重复
    9. 视觉风格一致性: 保持分割片段之间的视觉风格一致，避免风格突变
    10. 节奏控制: 根据内容调整片段时长
       - 快节奏动作: 1-3秒
       - 对话/表情: 2-4秒  
       - 风景/环境: 2-5秒
    
    ## 任务要求
    请分析这个镜头是否需要分割，并给出最佳的分割方案。
    
    ## 输出格式 (必须严格遵循JSON格式)
    {{
      "needs_split": true/false,
      "reason": "详细的分割理由或保持完整的理由",
      "segments": [
        {{
          "duration": 数字（秒，范围{min_segment}-{max_segment}）,
          "description": "详细的片段描述（保持与原始描述一致）",
          "key_frames": ["关键帧描述1", "关键帧描述2"],
          "continuity_hints": ["需要保持一致的视觉元素"]
        }}
      ],
      "continuity_plan": {{
        "character_consistency": "如何保持角色一致性",
        "scene_consistency": "如何保持场景一致性",
        "transition_suggestions": ["转场建议"]
      }}
    }}
    
    ## 示例，输入: 10秒的对话镜头
    输出: {{
      "needs_split": true,
      "reason": "对话较长，可以按对话内容自然分割为三个片段",
      "segments": [
        {{
          "duration": 3.5,
          "description": "角色A开始说话，表情严肃",
          "key_frames": ["角色A正面特写", "角色B倾听表情"],
          "continuity_hints": ["角色A的服装", "背景灯光"]
        }},
        {{
          "duration": 3.0,
          "description": "角色B回应，手势强调",
          "key_frames": ["角色B手势特写", "角色A反应"],
          "continuity_hints": ["角色位置", "环境细节"]
        }},
        {{
          "duration": 3.5,
          "description": "两人同时说话，气氛紧张",
          "key_frames": ["双人镜头", "紧张的面部表情"],
          "continuity_hints": ["角色间距", "面部表情变化"]
        }}
      ]
    }}
    
    请直接返回JSON，不要其他文字。