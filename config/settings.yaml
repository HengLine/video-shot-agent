# 应用程序配置文件，包含API、LLM、嵌入模型、分镜生成等各项配置。
# 此配置只是默认值，系统优先使用环境变量或命令行参数。
app:
  name: "Script-to-Shot AI Agent"
  version: "1.0.0"
  description: "脚本转分镜AI助手"
  environment: "development"
  language: "zh"

api:
  host: "127.0.0.1"
  port: 8000
  workers: 1
  reload: true
  cors_origins:
    - "http://localhost:3000"
    - "http://127.0.0.1:3000"
    - "http://localhost:8000"
  api_prefix: "/api"
  docs_url: "/docs"

#################### LLM配置 #####################
llm:
  default:
    base_url: "https://api.openai.com/v1"
    api_key: ""
    model_name: "gpt-4o"
    timeout: 60
    response_format: "json_object"
    temperature: 0.1
    max_tokens: 2000
    max_retries: 3
    retry_delay: 1

  # 备用llm模型配置
  fallback:
    base_url: "http://localhost:11434"
    api_key: ""
    model_name: "qwen3:8b"
    response_format: "json_object"
    timeout: 60
    temperature: 0.1
    max_tokens: 2000
    max_retries: 3
    retry_delay: 1

#################### 嵌入模型配置 #####################
embed:
  default:
    base_url: "https://api.openai.com/v1"
    api_key: ""
    model_name: "text-embedding-3-small"
    device: "gpu"
    normalize_embeddings: true
    dimensions: 1536
    timeout: 60
    max_retries: 3

  # 备用嵌入模型配置
  fallback:
    base_url: "http://localhost:11434"
    api_key: ""
    model_name: "qllama/bge-small-zh-v1.5"
    device: "gpu"
    timeout: 60
    max_retries: 3

#################### 分镜配置 #####################
storyboard:
  generation:
    default_duration_per_shot: 5
    max_duration_deviation: 0.5
    max_retries: 2
    default_style: "realistic"
    supported_styles:
      - "realistic"
      - "anime"
      - "cinematic"
      - "cartoon"
      - "fantasy"
      - "sci-fi"
      - "documentary"

  structure:
    min_shots: 1
    max_shots: 50
    default_scenes_per_shot: 1
    enable_transitions: true
    include_dialogue: true
    include_camera_angles: true

  output:
    format: "json"
    include_timestamps: true
    include_visual_descriptions: true
    include_character_list: true
    include_location_list: true
    include_shot_duration: true

#################### 路径配置 #####################
paths:
  data:
    input: "./data/input"
    output: "./data/output"
    cache: "./data/cache"

  models:
    base: "./data/models"
    embeddings: "./data/models/embeddings"
    llm_cache: "./data/models/llm_cache"

  cache:
    base: "./data/cache"
    embeddings: "./data/cache/embeddings"
    llm_responses: "./data/cache/llm_responses"

  logs:
    base: "./logs"
    app: "./logs/app"
    api: "./logs/api"
    errors: "./logs/errors"

  temp:
    base: "./tmp"
    uploads: "./tmp/uploads"
    processed: "./tmp/processed"

#################### 向量存储配置 #####################
vector_store:
  provider: "chroma"

  chroma:
    persist_directory: "./data/vector_store"
    collection_name: "script_embeddings"
    embedding_function: "default"
    distance_metric: "cosine"

#################### 缓存配置 #####################
cache:
  memory:
    enabled: true
    ttl: 300
    max_size: 1000

  redis:
    enabled: false

  file:
    enabled: true
    directory: "./data/cache"
    ttl: 86400  # 24小时

  llm_response:
    ttl: 3600  # 1小时
    max_items: 1000

  embedding:
    ttl: 604800  # 7天
    max_items: 10000

#################### 处理配置 #####################
processing:
  max_workers: 4
  max_concurrent_tasks: 10
  task_timeout: 300  # 5分钟

  max_retries: 3
  retry_delay: 5
  backoff_factor: 2

  batch_size: 10
  batch_timeout: 30

#################### 上传配置 #####################
upload:
  max_file_size: "10MB"
  allowed_extensions:
    - ".txt"
    - ".md"
    - ".pdf"
    - ".doc"
    - ".docx"
    - ".json"
  max_files_per_request: 5
  chunk_size: 1024 * 1024  # 1MB

#################### 监控配置 #####################
monitoring:
  health:
    enabled: true
    endpoint: "/health"
    check_interval: 30

  metrics:
    enabled: false

  tracing:
    enabled: false

#################### 功能开关 #####################
features:
  enable_api: true
  enable_cli: true
  enable_webui: false
  enable_batch_processing: true
  enable_cache: true
  enable_validation: true
  enable_rate_limiting: false
  enable_auth: false

#################### 开发工具 #####################
development:
  enable_hot_reload: true
  enable_debug_endpoints: true
  log_level: "DEBUG"
  profile_requests: false